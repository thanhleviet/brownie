\name{addCensored}
\alias{addCensored}
\title{
Add Censored ratetest to brownie object
}
\description{
This function adds a character string to the the commands slot of a brownie object (or list of brownie objects) which instructs the brownie program to run a censored ratetest.
}
\usage{
addCensored(obj, file = NULL, reps = 0, taxset = character(0), treeloop = FALSE, charloop = FALSE, quiet = FALSE, usetempfile = FALSE, ...)
}
\arguments{
  \item{obj}{
A brownie object
}
  \item{file}{
The brownie core write the output of the ratetest to this file (optional)
}
  \item{reps}{
Number of bootstrap repetitions to run (calculates the bootstrap p-value) (optional).
}
  \item{taxset}{
Taxaset (from taxaset slot) which names the taxaset you are interested in comparing the rates of evolution over.  The inverse of this taxaset is automatically generated by the brownie core.
}
  \item{treeloop}{
Should the analysis loop across the trees?  To use a specific tree then run the addChoose(tree=<TREENUM>) before this command.
}
  \item{charloop}{
Should the analysis loop across characters?  To use a specific character then run the addChoose(char=<CHARNUM>) before this command.
}
  \item{quiet}{
Verbose output (only output to screen, output to file does not change)
}
  \item{usetempfile}{
Should a tempfile be written to (instead of file).  Not currently used.
}
  \item{\dots}{
Not currently used.
}
}
\details{
The censored ratetest compares the rates of evolution in a monophyletic clade to another monophyletic of paraphyletic clade (i.e. rate change only occurs at nodes).  It is useful for asking questions about whether a key character has lead to increased rates of evolution.  It is 'censored' as it removes the branches that join the two clades together as it is not clear which clade to assign these branches to.
}
\value{
Returns the original object (obj) with ratetest command added.
}
\references{
%% ~put references to the literature/web site here ~
}
\author{
J. Conrad Stack
}
\note{
%%  ~~further notes~~
}

%% ~Make other sections like Warning with \section{Warning }{....} ~

\seealso{
%% ~~objects to See Also as \code{\link{help}}, ~~~
}
\examples{
##---- Should be DIRECTLY executable !! ----
##-- ==>  Define data, use random,
##--	or do  help(data=index)  for the standard data sets.

## The function is currently defined as
function (obj, file = NULL, reps = 0, taxset = character(0), 
    treeloop = FALSE, charloop = FALSE, quiet = FALSE, usetempfile = FALSE, 
    ...) 
{
    if (!is.list(obj)) {
        obj = list(obj)
    }
    newcmd = list(command = NULL, options = matrix(NA, ncol = 2, 
        nrow = 0))
    newcmd$command = "ratetest"
    if (length(taxset) != 0 && is.character(taxset)) 
        for (jj in seq(length(taxset))) newcmd = addcmd.taxaset(obj[[1]], 
            newcmd, taxset[jj])
    newcmd = addcmd.literal(newcmd, "reps", as.character(reps))
    newcmd = addcmd.binary(newcmd, "treeloop", treeloop)
    newcmd = addcmd.binary(newcmd, "charloop", charloop)
    newcmd = addcmd.binary(newcmd, "quiet", quiet)
    if (!usetempfile && !is.null(file) && is.character(file)) {
        newcmd = addcmd.literal(newcmd, "file", file[1])
    }
    else {
        if (usetempfile) {
            newcmd = addcmd.literal(newcmd, "file", tempfile())
        }
        else {
        }
    }
    if (length(taxset) != 0) 
        for (jj in seq(length(taxset))) if (!all(sapply(obj, 
            areTaxaMono, taxset[jj]))) 
            warning("In some trees the taxaset,", taxset[jj], 
                ", does not form a monophyletic clade.  Might want to remove those trees before running this analysis")
    for (ii in seq(length(obj))) {
        commands(obj[[ii]], add = T) <- write.brownie.string(newcmd)
    }
    if (length(obj) == 1) 
        obj = obj[[1]]
    return(obj)
  }
}
% Add one or more standard keywords, see file 'KEYWORDS' in the
% R documentation directory.
\keyword{ methods }

